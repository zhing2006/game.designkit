---
description: 执行游戏设计任务，按 tasks.md 的规划逐项完成设计工作
---

## User Input

```text
$ARGUMENTS
```

在继续之前，**必须**考虑用户输入（如果非空）。

## 执行流程概述

1. 从仓库根目录运行 `.game.design/scripts/bash/check-prerequisites.sh --json --require-tasks --include-tasks` 并解析 FEATURE_DIR 和 AVAILABLE_DOCS。所有路径必须是绝对路径。对于参数中的单引号（如 "I'm Groot"），使用转义语法：'I'\''m Groot'（或使用双引号："I'm Groot"）。

2. **检查清单状态**（如果 FEATURE_DIR/checklists/ 存在）：
   - 扫描 checklists/ 目录中的所有清单文件
   - 对每个清单，计数：
     - 总项目：所有匹配 `- [ ]` 或 `- [X]` 或 `- [x]` 的行
     - 已完成项目：匹配 `- [X]` 或 `- [x]` 的行
     - 未完成项目：匹配 `- [ ]` 的行
   - 创建状态表：

     ```text
     | 清单文件 | 总计 | 已完成 | 未完成 | 状态 |
     |---------|------|--------|--------|------|
     | requirements.md     | 16   | 16     | 0      | ✓ 通过 |
     | design-quality.md   | 10   | 8      | 2      | ✗ 失败 |
     | pillar-alignment.md | 8    | 8      | 0      | ✓ 通过 |
     ```

   - 计算总体状态：
     - **通过**：所有清单的未完成项目数为 0
     - **失败**：一个或多个清单有未完成项目

   - **如果任何清单未完成**：
     - 显示包含未完成项目计数的表格
     - **停止**并询问："某些清单未完成。是否继续实施？(yes/no)"
     - 等待用户响应
     - 如果用户说"no"或"wait"或"stop"，暂停执行
     - 如果用户说"yes"或"proceed"或"continue"，继续步骤 3

   - **如果所有清单已完成**：
     - 显示所有清单通过的表格
     - 自动继续步骤 3

3. 加载并分析实施上下文：
   - **必需**：读取 tasks.md 获取完整任务列表和执行计划
   - **必需**：读取 plan.md 获取设计方法、架构和文件结构
   - **如果存在**：读取 research.md 获取设计决策和约束
   - **如果存在**：读取 quickstart.md 获取快速入门信息

4. 解析 tasks.md 结构并提取：
   - **任务阶段**：Setup、用户故事阶段、Polish
   - **任务依赖**：顺序 vs 并行执行规则
   - **任务详情**：ID、描述、文件路径、并行标记 [P]
   - **执行流程**：顺序和依赖需求

5. 按照任务计划执行实施：
   - **按阶段执行**：在进入下一阶段前完成当前阶段
   - **遵循依赖**：顺序任务按序运行，并行任务 [P] 可同时运行
   - **基于文件协调**：影响相同文件的任务必须顺序运行
   - **验证检查点**：在继续前验证每个阶段完成

6. 执行规则：
   - **Setup first**: 验证前置文件、创建设计文档目录
   - **核心工作**: 编写设计文档（gameplay-design.md、numerical-framework.md 等）
   - **完善工作**: 补充设计文档间的引用关系
   - **润色**: 审查一致性、验证支柱对齐

7. 进度跟踪和错误处理：
   - 每完成一个任务后报告进度
   - 如果任何非并行任务失败则暂停执行
   - 对于并行任务 [P]，继续成功的任务，报告失败的任务
   - 提供带有调试上下文的清晰错误消息
   - 如果实施无法继续，建议下一步
   - **重要**：对于已完成的任务，确保在 tasks 文件中标记为 [X]

8. 完成验证：
   - 验证所有必需任务已完成
   - 检查设计文档是否符合原始规范
   - 验证设计文档完整性和一致性
   - 确认设计符合设计方案
   - 报告最终状态及完成的设计工作摘要

注意：本命令假设 tasks.md 中存在完整的任务分解。如果任务不完整或缺失，建议先运行 `/game.designkit.tasks` 重新生成任务列表。
